import{r as x,j as e,a as g,b as R}from"./app-Dfy-5Wtn.js";import{a9 as c,aa as A,$ as p,I as r,a6 as E,a8 as F,aj as C,a0 as H,U,ab as I,ac as O,ad as $,ae as P,af as y,ag as z,ah as q}from"./GuestLayout-ggNW2DBW.js";import{C as h,A as J}from"./Container-CZyyH65x.js";import{T as K}from"./TablePagination-22o4qLoC.js";const Q=({title:s})=>{console.log(s);const n={wika:!1,swagelo:!1,hylok:!1,hy_lok:!1,fluidLine:!1},[i,a]=x.useState(n);return x.useEffect(()=>{switch(s){case"wika":a({...i,wika:!0});break;case"swagelo":a({...i,swagelo:!0});break;case"hylok":a({...i,hylok:!0});break;case"hy-lok":a({...i,hy_lok:!0});break;case"fluidLine":a({...i,fluidLine:!0});break}},[s]),e.jsx(c,{container:!0,sx:{padding:"10px"},children:e.jsx(c,{item:!0,xs:12,children:e.jsxs(A,{color:"info",variant:"contained",size:"large","aria-label":"Large button group",children:[e.jsx(g,{href:route("wika"),children:e.jsx(p,{disabled:i.wika,children:"Wika"})}),e.jsx(g,{href:route("swagelo"),children:e.jsx(p,{disabled:i.swagelo,children:"Swagelo"})}),e.jsx(g,{href:route("hylok"),children:e.jsx(p,{disabled:i.hylok,children:"Hylok"})}),e.jsx(g,{href:route("hy-lok"),children:e.jsx(p,{disabled:i.hy_lok,children:"Hy-lok"})}),e.jsx(g,{href:route("fluidLine"),children:e.jsx(p,{disabled:i.fluidLine,children:"fluidLine"})})]})})})};function V({open:s,handleClose:n,dataModal:i,skeleton:a,data:v,errAlert:k}){const w=x.useCallback(b=>{const _=[];for(let f in b)_.push(e.jsxs(c,{container:!0,className:"card_group",children:[e.jsx(c,{item:!0,xs:12,children:e.jsx(r,{variant:"h4",children:f})}),e.jsx(c,{container:!0,className:"card_group_items",children:b[f].map((t,m)=>{let u="";switch(t.invoice_status){case 0:u="счет создан";break;case 1:u="счет выставлен";break;case 2:u="счет оплачен";break}return t.title=="1С"?e.jsx(c,{className:"card",container:!0,children:e.jsx(c,{item:!0,xs:12,children:e.jsxs(h,{sx:{display:"flex",flexDirection:"column"},children:[e.jsx(r,{variant:"h5",children:t.title}),e.jsxs(r,{className:"card_text",variant:"p",children:[e.jsx("span",{className:"titile_header",children:"Статус заказа: "}),e.jsx("span",{children:u})]}),e.jsxs(r,{className:"card_text",variant:"p",children:[e.jsx("span",{className:"titile_header",children:"Сумма заказа: "}),e.jsx("span",{children:t.invoice_price})]}),e.jsxs(r,{className:"card_text",variant:"p",children:[e.jsx("span",{className:"titile_header",children:"Дата заказа: "}),e.jsx("span",{children:t.invoice_date})]})]})})},m+t.invoice_date):e.jsx(c,{className:"card",container:!0,children:e.jsx(c,{item:!0,xs:12,children:e.jsxs(h,{sx:{display:"flex",flexDirection:"column"},children:[e.jsx(r,{variant:"h5",children:t.title}),e.jsxs(r,{className:"card_text",variant:"p",children:[e.jsx("span",{className:"titile_header",children:"Дата просмотра: "}),e.jsx("span",{children:t.date})]}),e.jsxs(r,{className:"card_text",variant:"p",children:[e.jsx("span",{className:"titile_header",children:"Просмотр: "}),e.jsx("span",{children:t.url})]}),e.jsxs(r,{className:"card_text",variant:"p",children:[e.jsx("span",{className:"titile_header",children:"домен: "}),e.jsx("span",{children:t.favicon})]}),t.adGroupName?e.jsxs(r,{className:"card_text",variant:"p",children:[e.jsx("span",{className:"titile_header",children:"Название рекламной группы: "}),e.jsx("span",{children:t.adGroupName})]}):"",t.adGroupName?e.jsxs(r,{className:"card_text",variant:"p",children:[e.jsx("span",{className:"titile_header",children:"Название рекламной компании: "}),e.jsx("span",{children:t.campaignName})]}):"",t.adGroupName?e.jsxs(r,{className:"card_text",variant:"p",children:[e.jsx("span",{className:"titile_header",children:"Ключевая фраза: "}),e.jsx("span",{children:t.keyPhrase})]}):"",t.adGroupName?e.jsxs(r,{className:"card_text",variant:"p",children:[e.jsx("span",{className:"titile_header",children:"Город: "}),e.jsx("span",{children:t.city})]}):"",t.adGroupName?e.jsxs(r,{className:"card_text",variant:"p",children:[e.jsx("span",{className:"titile_header",children:"Стоимость перехода по ссылке: "}),e.jsx("span",{children:t.avgCpc})]}):"",e.jsxs(r,{className:"card_text",variant:"p",children:[e.jsx("span",{className:"titile_header",children:"посещения: "}),e.jsx("span",{children:t.meric_visits})]}),e.jsxs(r,{className:"card_text",variant:"p",children:[e.jsx("span",{className:"titile_header",children:"пользователи: "}),e.jsx("span",{children:t.meric_users})]})]})})},m)})})]}));return _});return e.jsx(x.Fragment,{children:e.jsxs(E,{open:s,onClose:n,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",maxWidth:"xl",children:[e.jsx(F,{children:e.jsxs(c,{container:!0,spacing:2,children:[e.jsx(c,{item:!0,xs:4,sx:{width:"800px",height:"650px"},children:e.jsxs(h,{sx:{width:500,position:"fixed","&, css-1xgtf4e-MuiContainer-root":{padding:0}},children:[e.jsxs(h,{sx:{marginBottom:1.2},children:[e.jsx("p",{className:"titile_header",children:"Название сайта: "}),e.jsx("p",{children:i.headers.title})]}),e.jsxs(h,{sx:{marginBottom:1.2},children:[e.jsx("p",{className:"titile_header",children:"Код клиента: "}),e.jsx("p",{children:i.headers.code})]}),e.jsxs(h,{sx:{marginBottom:1.2},children:[e.jsx("p",{className:"titile_header",children:"Электронная почта: "}),e.jsx("p",{children:i.headers.mail})]}),e.jsxs(h,{sx:{marginBottom:1.2},children:[e.jsx("p",{className:"titile_header",children:"ID клиента: "}),e.jsx("p",{children:i.headers.id})]}),e.jsxs(h,{sx:{marginBottom:1.2},children:[e.jsx("p",{className:"titile_header",children:"Яндекс ID клиента: "}),e.jsx("p",{children:i.headers.ym_uid})]}),e.jsxs(h,{sx:{marginBottom:1.2},children:[e.jsx("p",{className:"titile_header",children:"Количество переходов по ссылке: "}),e.jsx("p",{children:i.headers.countClicks})]}),e.jsxs(h,{sx:{marginBottom:1.2},children:[e.jsx("p",{className:"titile_header",children:"общая стоимость переходов по ссылке: "}),e.jsx("p",{children:i.headers.costClicks})]}),e.jsxs(h,{sx:{marginBottom:1.2},children:[e.jsx("p",{className:"titile_header",children:"Сумма оплаты: "}),e.jsx("p",{children:i.headers.sumPrice})]})]})}),e.jsxs(c,{item:!0,xs:8,children:[a?"":e.jsxs(e.Fragment,{children:[e.jsx(c,{container:!0,className:"card_group",children:e.jsx(c,{container:!0,className:"card_group_items",children:e.jsx(C,{variant:"rectangular",width:960,height:260})})}),e.jsx("br",{}),e.jsx(c,{container:!0,className:"card_group",children:e.jsx(c,{container:!0,className:"card_group_items",children:e.jsx(C,{variant:"rectangular",width:960,height:260})})})]}),i?w(i.data):"",k?e.jsx(c,{container:!0,className:"card_group",children:e.jsx(c,{item:!0,xs:12,children:e.jsx(r,{variant:"h4",children:e.jsx(J,{severity:"error",children:"Данные о пользователе отсутствуют !"})})})}):""]})]})}),e.jsx(H,{children:e.jsx(p,{onClick:n,children:"Закрыть"})})]})})}const D=[{id:"mail",label:"Mail",minWidth:170},{id:"created",label:"счет создан",minWidth:100},{id:"actived",label:"выставлен клиенту на оплату",minWidth:170,align:"center"},{id:"closed",label:"пришла оплата",minWidth:170,align:"center"},{id:"createdPrice",label:"сумма созданных счетов",minWidth:170,align:"center",format:s=>s.toFixed(2)},{id:"activedPrice",label:"выставленная сумма на оплату",minWidth:170,align:"center",format:s=>s.toFixed(2)},{id:"closedPrice",label:"сума оплаченных счетов",minWidth:170,align:"center",format:s=>s.toFixed(2)}];function S(s){const[n,i]=s.split("@");let a="";return i==null?a="**********":a=i.replace(/./g,"*"),`${n}@${a}`}const X=s=>{const n=[],i={};s.forEach(a=>{i.hasOwnProperty(a.client_mail)?i[a.client_mail]={created:a.invoice_status==0?i[a.client_mail].created+1:i[a.client_mail].created,createdPrice:a.invoice_status==0?i[a.client_mail].createdPrice+Number(a.invoice_price):i[a.client_mail].createdPrice,actived:a.invoice_status==1?i[a.client_mail].actived+1:i[a.client_mail].actived,activedPrice:a.invoice_status==1?i[a.client_mail].activedPrice+Number(a.invoice_price):i[a.client_mail].activedPrice,closed:a.invoice_status==2?i[a.client_mail].closed+1:i[a.client_mail].closed,closedPrice:a.invoice_status==2?i[a.client_mail].closedPrice+Number(a.invoice_price):i[a.client_mail].closedPrice}:i[a.client_mail]={created:a.invoice_status==0?1:0,createdPrice:a.invoice_status==0?Number(a.invoice_price):0,actived:a.invoice_status==1?1:0,activedPrice:a.invoice_status==1?Number(a.invoice_price):0,closed:a.invoice_status==2?1:0,closedPrice:a.invoice_status==2?Number(a.invoice_price):0}});for(let a in i)n.push({id:a,mail:S(a),created:i[a].created,actived:i[a].actived,closed:i[a].closed,createdPrice:i[a].createdPrice,activedPrice:i[a].activedPrice,closedPrice:i[a].closedPrice});return n};function Y({data:s}){const[n,i]=x.useState(0),[a,v]=x.useState(10),[k,w]=x.useState(X(s.rows)),[b,_]=x.useState(!1),[f,t]=x.useState(!1),[m,u]=x.useState({headers:{title:s.title,code:"",id:"",mail:"",ym_uid:"",countClicks:"",costClicks:"",sumPrice:""},data:{}}),[W,N]=x.useState(!1),B=()=>{_(!1),u({headers:{title:s.title,code:"",id:"",mail:"",ym_uid:"",countClicks:"",costClicks:"",sumPrice:""},data:{}})},T=d=>{_(!0),N(!1),t(!1);const j=new FormData;j.set("mail",d);let o="";switch(m.headers.title){case"wika":o="wika.general";break;case"swagelo":o="swagelo.general";break;case"hylok":o="hylok.general";break;case"hy-lok":o="hy-lok.general";break;case"fluidLine":o="fluidLine.general";break}R.post(route(o),j).then(l=>{N(!0),u({...m,data:l.data.data,headers:{title:m.headers.title,code:l.data.client_code,id:l.data.client_id,mail:S(l.data.client_mail),ym_uid:l.data.client_ym_uid??"отсутствует",countClicks:l.data.countClicks??"отсутствует",costClicks:l.data.costClicks??"отсутствует",sumPrice:l.data.sum_price}})}).catch(l=>{t(!0),N(!0),console.log(l)})},G=(d,j)=>{i(j)},L=d=>{v(+d.target.value),i(0)};return e.jsxs(U,{sx:{width:"100%",margin:"0 auto"},children:[e.jsx(I,{sx:{maxHeight:600},children:e.jsxs(O,{stickyHeader:!0,"aria-label":"sticky table",children:[e.jsxs($,{children:[e.jsx(P,{children:e.jsx(y,{size:"string",align:"left",colSpan:12,children:e.jsx(r,{variant:"h3",children:s.title})})}),e.jsx(P,{children:D.map(d=>e.jsx(y,{align:d.align,style:{top:57,minWidth:d.minWidth},children:d.label},d.id))})]}),e.jsx(z,{children:k.slice(n*a,n*a+a).map((d,j)=>e.jsx(P,{hover:!0,role:"checkbox",tabIndex:-1,sx:{cursor:"pointer"},onClick:()=>T(d.id),children:D.map(o=>{const l=d[o.id];return e.jsx(y,{align:o.align,children:o.format&&typeof l=="number"?o.format(l):l},o.id)})},j))})]})}),e.jsx(K,{rowsPerPageOptions:[10,25,100],component:"div",count:k.length,rowsPerPage:a,page:n,onPageChange:G,onRowsPerPageChange:L,labelRowsPerPage:"Выводить по :"}),e.jsx(V,{dataModal:m,handleClose:B,open:b,skeleton:W,errAlert:f})]})}const ie=({data:s})=>{console.log(s);const[n,i]=x.useState(s.dateUpdateDirect),a=v=>{i(v)};return e.jsxs(q,{dateUpdateDirect:n,updateDirectDate:a,children:[e.jsx(Q,{title:s.title}),e.jsx(h,{maxWidth:"1600px",children:e.jsx(Y,{data:s})})]})};export{ie as default};
