import{r as h,j as e,a as N,b as G}from"./app-rXjYUJAF.js";import{ae as c,af as R,a5 as _,Q as r,ab as F,ad as E,ao as y,a6 as H,P as U,ag as I,ah as O,ai as z,aj as P,ak as f,al as A,am as $}from"./GuestLayout-BAdTHTcx.js";import{C as o}from"./Container-Dhi6tsEm.js";import{T as L}from"./TablePagination-D2iMuyxA.js";const Q=({title:t})=>{console.log(t);const n={wika:!1,swagelo:!1,hylok:!1,hy_lok:!1},[s,a]=h.useState(n);return h.useEffect(()=>{switch(t){case"wika":a({...s,wika:!0});break;case"swagelo":a({...s,swagelo:!0});break;case"hylok":a({...s,hylok:!0});break;case"hy-lok":a({...s,hy_lok:!0});break}},[t]),e.jsx(c,{container:!0,sx:{padding:"10px"},children:e.jsx(c,{item:!0,xs:12,children:e.jsxs(R,{color:"info",variant:"contained",size:"large","aria-label":"Large button group",children:[e.jsx(N,{href:route("wika"),children:e.jsx(_,{disabled:s.wika,children:"Wika"})}),e.jsx(N,{href:route("swagelo"),children:e.jsx(_,{disabled:s.swagelo,children:"Swagelo"})}),e.jsx(N,{href:route("hylok"),children:e.jsx(_,{disabled:s.hylok,children:"Hylok"})}),e.jsx(N,{href:route("hy-lok"),children:e.jsx(_,{disabled:s.hy_lok,children:"Hy-lok"})})]})})})};function q({open:t,handleClose:n,dataModal:s,skeleton:a,data:g}){const v=h.useCallback(b=>{const k=[];for(let j in b)k.push(e.jsxs(c,{container:!0,className:"card_group",children:[e.jsx(c,{item:!0,xs:12,children:e.jsx(r,{variant:"h4",children:j})}),e.jsx(c,{container:!0,className:"card_group_items",children:b[j].map((i,u)=>{let m="";switch(i.invoice_status){case 0:m="счет создан";break;case 1:m="счет выставлен";break;case 2:m="счет оплачен";break}return i.title=="1С"?e.jsx(c,{className:"card",container:!0,children:e.jsx(c,{item:!0,xs:12,children:e.jsxs(o,{sx:{display:"flex",flexDirection:"column"},children:[e.jsx(r,{variant:"h5",children:i.title}),e.jsxs(r,{className:"card_text",variant:"p",children:[e.jsx("span",{className:"titile_header",children:"Статус заказа: "}),e.jsx("span",{children:m})]}),e.jsxs(r,{className:"card_text",variant:"p",children:[e.jsx("span",{className:"titile_header",children:"Сумма заказа: "}),e.jsx("span",{children:i.invoice_price})]}),e.jsxs(r,{className:"card_text",variant:"p",children:[e.jsx("span",{className:"titile_header",children:"Дата заказа: "}),e.jsx("span",{children:i.invoice_date})]})]})})},u+i.invoice_date):e.jsx(c,{className:"card",container:!0,children:e.jsx(c,{item:!0,xs:12,children:e.jsxs(o,{sx:{display:"flex",flexDirection:"column"},children:[e.jsx(r,{variant:"h5",children:i.title}),e.jsxs(r,{className:"card_text",variant:"p",children:[e.jsx("span",{className:"titile_header",children:"Дата просмотра: "}),e.jsx("span",{children:i.date})]}),e.jsxs(r,{className:"card_text",variant:"p",children:[e.jsx("span",{className:"titile_header",children:"Просмотр: "}),e.jsx("span",{children:i.url})]}),e.jsxs(r,{className:"card_text",variant:"p",children:[e.jsx("span",{className:"titile_header",children:"домен: "}),e.jsx("span",{children:i.favicon})]}),i.adGroupName?e.jsxs(r,{className:"card_text",variant:"p",children:[e.jsx("span",{className:"titile_header",children:"Название рекламной группы: "}),e.jsx("span",{children:i.adGroupName})]}):"",i.adGroupName?e.jsxs(r,{className:"card_text",variant:"p",children:[e.jsx("span",{className:"titile_header",children:"Название рекламной компании: "}),e.jsx("span",{children:i.campaignName})]}):"",i.adGroupName?e.jsxs(r,{className:"card_text",variant:"p",children:[e.jsx("span",{className:"titile_header",children:"Ключевая фраза: "}),e.jsx("span",{children:i.keyPhrase})]}):"",i.adGroupName?e.jsxs(r,{className:"card_text",variant:"p",children:[e.jsx("span",{className:"titile_header",children:"Город: "}),e.jsx("span",{children:i.city})]}):"",i.adGroupName?e.jsxs(r,{className:"card_text",variant:"p",children:[e.jsx("span",{className:"titile_header",children:"Стоимость перехода по ссылке: "}),e.jsx("span",{children:i.avgCpc})]}):"",e.jsxs(r,{className:"card_text",variant:"p",children:[e.jsx("span",{className:"titile_header",children:"посещения: "}),e.jsx("span",{children:i.meric_visits})]}),e.jsxs(r,{className:"card_text",variant:"p",children:[e.jsx("span",{className:"titile_header",children:"пользователи: "}),e.jsx("span",{children:i.meric_users})]})]})})},u)})})]}));return k});return e.jsx(h.Fragment,{children:e.jsxs(F,{open:t,onClose:n,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",maxWidth:"xl",children:[e.jsx(E,{children:e.jsxs(c,{container:!0,spacing:2,children:[e.jsx(c,{item:!0,xs:4,sx:{width:"800px",height:"650px"},children:e.jsxs(o,{sx:{width:500,position:"fixed","&, css-1xgtf4e-MuiContainer-root":{padding:0}},children:[e.jsxs(o,{sx:{marginBottom:1.2},children:[e.jsx("p",{className:"titile_header",children:"Название сайта: "}),e.jsx("p",{children:s.headers.title})]}),e.jsxs(o,{sx:{marginBottom:1.2},children:[e.jsx("p",{className:"titile_header",children:"Код клиента: "}),e.jsx("p",{children:s.headers.code})]}),e.jsxs(o,{sx:{marginBottom:1.2},children:[e.jsx("p",{className:"titile_header",children:"Электронная почта: "}),e.jsx("p",{children:s.headers.mail})]}),e.jsxs(o,{sx:{marginBottom:1.2},children:[e.jsx("p",{className:"titile_header",children:"ID клиента: "}),e.jsx("p",{children:s.headers.id})]}),e.jsxs(o,{sx:{marginBottom:1.2},children:[e.jsx("p",{className:"titile_header",children:"Яндекс ID клиента: "}),e.jsx("p",{children:s.headers.ym_uid})]}),e.jsxs(o,{sx:{marginBottom:1.2},children:[e.jsx("p",{className:"titile_header",children:"Количество переходов по ссылке: "}),e.jsx("p",{children:s.headers.countClicks})]}),e.jsxs(o,{sx:{marginBottom:1.2},children:[e.jsx("p",{className:"titile_header",children:"общая стоимость переходов по ссылке: "}),e.jsx("p",{children:s.headers.costClicks})]}),e.jsxs(o,{sx:{marginBottom:1.2},children:[e.jsx("p",{className:"titile_header",children:"Сумма оплаты: "}),e.jsx("p",{children:s.headers.sumPrice})]})]})}),e.jsxs(c,{item:!0,xs:8,children:[a?"":e.jsxs(e.Fragment,{children:[e.jsx(c,{container:!0,className:"card_group",children:e.jsx(c,{container:!0,className:"card_group_items",children:e.jsx(y,{variant:"rectangular",width:960,height:260})})}),e.jsx("br",{}),e.jsx(c,{container:!0,className:"card_group",children:e.jsx(c,{container:!0,className:"card_group_items",children:e.jsx(y,{variant:"rectangular",width:960,height:260})})})]}),s?v(s.data):""]})]})}),e.jsx(H,{children:e.jsx(_,{onClick:n,children:"Закрыть"})})]})})}const C=[{id:"mail",label:"Mail",minWidth:170},{id:"created",label:"счет создан",minWidth:100},{id:"actived",label:"выставлен клиенту на оплату",minWidth:170,align:"center"},{id:"closed",label:"пришла оплата",minWidth:170,align:"center"},{id:"createdPrice",label:"сумма созданных счетов",minWidth:170,align:"center",format:t=>t.toFixed(2)},{id:"activedPrice",label:"выставленная сумма на оплату",minWidth:170,align:"center",format:t=>t.toFixed(2)},{id:"closedPrice",label:"сума оплаченных счетов",minWidth:170,align:"center",format:t=>t.toFixed(2)}];function D(t){const[n,s]=t.split("@"),a=s.replace(/./g,"*");return`${n}@${a}`}const J=t=>{const n=[],s={};t.forEach(a=>{s.hasOwnProperty(a.client_mail)?s[a.client_mail]={created:a.invoice_status==0?s[a.client_mail].created+1:s[a.client_mail].created,createdPrice:a.invoice_status==0?s[a.client_mail].createdPrice+Number(a.invoice_price):s[a.client_mail].createdPrice,actived:a.invoice_status==1?s[a.client_mail].actived+1:s[a.client_mail].actived,activedPrice:a.invoice_status==1?s[a.client_mail].activedPrice+Number(a.invoice_price):s[a.client_mail].activedPrice,closed:a.invoice_status==2?s[a.client_mail].closed+1:s[a.client_mail].closed,closedPrice:a.invoice_status==2?s[a.client_mail].closedPrice+Number(a.invoice_price):s[a.client_mail].closedPrice}:s[a.client_mail]={created:a.invoice_status==0?1:0,createdPrice:a.invoice_status==0?Number(a.invoice_price):0,actived:a.invoice_status==1?1:0,activedPrice:a.invoice_status==1?Number(a.invoice_price):0,closed:a.invoice_status==2?1:0,closedPrice:a.invoice_status==2?Number(a.invoice_price):0}});for(let a in s)n.push({id:a,mail:D(a),created:s[a].created,actived:s[a].actived,closed:s[a].closed,createdPrice:s[a].createdPrice,activedPrice:s[a].activedPrice,closedPrice:s[a].closedPrice});return n};function K({data:t}){const[n,s]=h.useState(0),[a,g]=h.useState(10),[v,b]=h.useState(J(t.rows)),[k,j]=h.useState(!1),[i,u]=h.useState({headers:{title:t.title,code:"",id:"",mail:"",ym_uid:"",countClicks:"",costClicks:"",sumPrice:""},data:{}}),[m,w]=h.useState(!1),S=()=>{j(!1),u({headers:{title:t.title,code:"",id:"",mail:"",ym_uid:"",countClicks:"",costClicks:"",sumPrice:""},data:{}})},W=d=>{j(!0),w(!1);const p=new FormData;p.set("mail",d);let x="";switch(i.headers.title){case"wika":x="wika.general";break;case"swagelo":x="swagelo.general";break;case"hylok":x="hylok.general";break}G.post(route(x),p).then(l=>{w(!0),u({...i,data:l.data.data,headers:{title:i.headers.title,code:l.data.client_code,id:l.data.client_id,mail:D(l.data.client_mail),ym_uid:l.data.client_ym_uid??"отсутствует",countClicks:l.data.countClicks??"отсутствует",costClicks:l.data.costClicks??"отсутствует",sumPrice:l.data.sum_price}})}).catch(l=>{console.log(l)})},B=(d,p)=>{s(p)},T=d=>{g(+d.target.value),s(0)};return e.jsxs(U,{sx:{width:"100%",margin:"0 auto"},children:[e.jsx(I,{sx:{maxHeight:600},children:e.jsxs(O,{stickyHeader:!0,"aria-label":"sticky table",children:[e.jsxs(z,{children:[e.jsx(P,{children:e.jsx(f,{size:"string",align:"left",colSpan:12,children:e.jsx(r,{variant:"h3",children:t.title})})}),e.jsx(P,{children:C.map(d=>e.jsx(f,{align:d.align,style:{top:57,minWidth:d.minWidth},children:d.label},d.id))})]}),e.jsx(A,{children:v.slice(n*a,n*a+a).map((d,p)=>e.jsx(P,{hover:!0,role:"checkbox",tabIndex:-1,sx:{cursor:"pointer"},onClick:()=>W(d.id),children:C.map(x=>{const l=d[x.id];return e.jsx(f,{align:x.align,children:x.format&&typeof l=="number"?x.format(l):l},x.id)})},p))})]})}),e.jsx(L,{rowsPerPageOptions:[10,25,100],component:"div",count:v.length,rowsPerPage:a,page:n,onPageChange:B,onRowsPerPageChange:T,labelRowsPerPage:"Выводить по :"}),e.jsx(q,{dataModal:i,handleClose:S,open:k,skeleton:m})]})}const M=({data:t})=>{console.log(t);const[n,s]=h.useState(t.dateUpdateDirect),a=g=>{s(g)};return e.jsxs($,{dateUpdateDirect:n,updateDirectDate:a,children:[e.jsx(Q,{title:t.title}),e.jsx(o,{maxWidth:"1600px",children:e.jsx(K,{data:t})})]})};export{M as default};
