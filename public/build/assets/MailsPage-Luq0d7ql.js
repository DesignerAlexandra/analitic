import{r as h,j as e,a as b,b as A}from"./app-DCyE_Wwt.js";import{a9 as c,aa as E,$ as _,I as r,a6 as F,a8 as H,aj as C,a0 as U,U as I,ab as O,ac as $,ad as z,ae as f,af as y,ag as L,ah as q}from"./GuestLayout-CV8Fs_CJ.js";import{C as o,A as J}from"./Container-DVS0d8iD.js";import{T as K}from"./TablePagination-wP-4vCDb.js";const Q=({title:i})=>{console.log(i);const n={wika:!1,swagelo:!1,hylok:!1,hy_lok:!1},[s,a]=h.useState(n);return h.useEffect(()=>{switch(i){case"wika":a({...s,wika:!0});break;case"swagelo":a({...s,swagelo:!0});break;case"hylok":a({...s,hylok:!0});break;case"hy-lok":a({...s,hy_lok:!0});break}},[i]),e.jsx(c,{container:!0,sx:{padding:"10px"},children:e.jsx(c,{item:!0,xs:12,children:e.jsxs(E,{color:"info",variant:"contained",size:"large","aria-label":"Large button group",children:[e.jsx(b,{href:route("wika"),children:e.jsx(_,{disabled:s.wika,children:"Wika"})}),e.jsx(b,{href:route("swagelo"),children:e.jsx(_,{disabled:s.swagelo,children:"Swagelo"})}),e.jsx(b,{href:route("hylok"),children:e.jsx(_,{disabled:s.hylok,children:"Hylok"})}),e.jsx(b,{href:route("hy-lok"),children:e.jsx(_,{disabled:s.hy_lok,children:"Hy-lok"})})]})})})};function V({open:i,handleClose:n,dataModal:s,skeleton:a,data:g,errAlert:v}){const w=h.useCallback(k=>{const u=[];for(let N in k)u.push(e.jsxs(c,{container:!0,className:"card_group",children:[e.jsx(c,{item:!0,xs:12,children:e.jsx(r,{variant:"h4",children:N})}),e.jsx(c,{container:!0,className:"card_group_items",children:k[N].map((t,m)=>{let j="";switch(t.invoice_status){case 0:j="счет создан";break;case 1:j="счет выставлен";break;case 2:j="счет оплачен";break}return t.title=="1С"?e.jsx(c,{className:"card",container:!0,children:e.jsx(c,{item:!0,xs:12,children:e.jsxs(o,{sx:{display:"flex",flexDirection:"column"},children:[e.jsx(r,{variant:"h5",children:t.title}),e.jsxs(r,{className:"card_text",variant:"p",children:[e.jsx("span",{className:"titile_header",children:"Статус заказа: "}),e.jsx("span",{children:j})]}),e.jsxs(r,{className:"card_text",variant:"p",children:[e.jsx("span",{className:"titile_header",children:"Сумма заказа: "}),e.jsx("span",{children:t.invoice_price})]}),e.jsxs(r,{className:"card_text",variant:"p",children:[e.jsx("span",{className:"titile_header",children:"Дата заказа: "}),e.jsx("span",{children:t.invoice_date})]})]})})},m+t.invoice_date):e.jsx(c,{className:"card",container:!0,children:e.jsx(c,{item:!0,xs:12,children:e.jsxs(o,{sx:{display:"flex",flexDirection:"column"},children:[e.jsx(r,{variant:"h5",children:t.title}),e.jsxs(r,{className:"card_text",variant:"p",children:[e.jsx("span",{className:"titile_header",children:"Дата просмотра: "}),e.jsx("span",{children:t.date})]}),e.jsxs(r,{className:"card_text",variant:"p",children:[e.jsx("span",{className:"titile_header",children:"Просмотр: "}),e.jsx("span",{children:t.url})]}),e.jsxs(r,{className:"card_text",variant:"p",children:[e.jsx("span",{className:"titile_header",children:"домен: "}),e.jsx("span",{children:t.favicon})]}),t.adGroupName?e.jsxs(r,{className:"card_text",variant:"p",children:[e.jsx("span",{className:"titile_header",children:"Название рекламной группы: "}),e.jsx("span",{children:t.adGroupName})]}):"",t.adGroupName?e.jsxs(r,{className:"card_text",variant:"p",children:[e.jsx("span",{className:"titile_header",children:"Название рекламной компании: "}),e.jsx("span",{children:t.campaignName})]}):"",t.adGroupName?e.jsxs(r,{className:"card_text",variant:"p",children:[e.jsx("span",{className:"titile_header",children:"Ключевая фраза: "}),e.jsx("span",{children:t.keyPhrase})]}):"",t.adGroupName?e.jsxs(r,{className:"card_text",variant:"p",children:[e.jsx("span",{className:"titile_header",children:"Город: "}),e.jsx("span",{children:t.city})]}):"",t.adGroupName?e.jsxs(r,{className:"card_text",variant:"p",children:[e.jsx("span",{className:"titile_header",children:"Стоимость перехода по ссылке: "}),e.jsx("span",{children:t.avgCpc})]}):"",e.jsxs(r,{className:"card_text",variant:"p",children:[e.jsx("span",{className:"titile_header",children:"посещения: "}),e.jsx("span",{children:t.meric_visits})]}),e.jsxs(r,{className:"card_text",variant:"p",children:[e.jsx("span",{className:"titile_header",children:"пользователи: "}),e.jsx("span",{children:t.meric_users})]})]})})},m)})})]}));return u});return e.jsx(h.Fragment,{children:e.jsxs(F,{open:i,onClose:n,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",maxWidth:"xl",children:[e.jsx(H,{children:e.jsxs(c,{container:!0,spacing:2,children:[e.jsx(c,{item:!0,xs:4,sx:{width:"800px",height:"650px"},children:e.jsxs(o,{sx:{width:500,position:"fixed","&, css-1xgtf4e-MuiContainer-root":{padding:0}},children:[e.jsxs(o,{sx:{marginBottom:1.2},children:[e.jsx("p",{className:"titile_header",children:"Название сайта: "}),e.jsx("p",{children:s.headers.title})]}),e.jsxs(o,{sx:{marginBottom:1.2},children:[e.jsx("p",{className:"titile_header",children:"Код клиента: "}),e.jsx("p",{children:s.headers.code})]}),e.jsxs(o,{sx:{marginBottom:1.2},children:[e.jsx("p",{className:"titile_header",children:"Электронная почта: "}),e.jsx("p",{children:s.headers.mail})]}),e.jsxs(o,{sx:{marginBottom:1.2},children:[e.jsx("p",{className:"titile_header",children:"ID клиента: "}),e.jsx("p",{children:s.headers.id})]}),e.jsxs(o,{sx:{marginBottom:1.2},children:[e.jsx("p",{className:"titile_header",children:"Яндекс ID клиента: "}),e.jsx("p",{children:s.headers.ym_uid})]}),e.jsxs(o,{sx:{marginBottom:1.2},children:[e.jsx("p",{className:"titile_header",children:"Количество переходов по ссылке: "}),e.jsx("p",{children:s.headers.countClicks})]}),e.jsxs(o,{sx:{marginBottom:1.2},children:[e.jsx("p",{className:"titile_header",children:"общая стоимость переходов по ссылке: "}),e.jsx("p",{children:s.headers.costClicks})]}),e.jsxs(o,{sx:{marginBottom:1.2},children:[e.jsx("p",{className:"titile_header",children:"Сумма оплаты: "}),e.jsx("p",{children:s.headers.sumPrice})]})]})}),e.jsxs(c,{item:!0,xs:8,children:[a?"":e.jsxs(e.Fragment,{children:[e.jsx(c,{container:!0,className:"card_group",children:e.jsx(c,{container:!0,className:"card_group_items",children:e.jsx(C,{variant:"rectangular",width:960,height:260})})}),e.jsx("br",{}),e.jsx(c,{container:!0,className:"card_group",children:e.jsx(c,{container:!0,className:"card_group_items",children:e.jsx(C,{variant:"rectangular",width:960,height:260})})})]}),s?w(s.data):"",v?e.jsx(c,{container:!0,className:"card_group",children:e.jsx(c,{item:!0,xs:12,children:e.jsx(r,{variant:"h4",children:e.jsx(J,{severity:"error",children:"Данные о пользователе отсутствуют !"})})})}):""]})]})}),e.jsx(U,{children:e.jsx(_,{onClick:n,children:"Закрыть"})})]})})}const D=[{id:"mail",label:"Mail",minWidth:170},{id:"created",label:"счет создан",minWidth:100},{id:"actived",label:"выставлен клиенту на оплату",minWidth:170,align:"center"},{id:"closed",label:"пришла оплата",minWidth:170,align:"center"},{id:"createdPrice",label:"сумма созданных счетов",minWidth:170,align:"center",format:i=>i.toFixed(2)},{id:"activedPrice",label:"выставленная сумма на оплату",minWidth:170,align:"center",format:i=>i.toFixed(2)},{id:"closedPrice",label:"сума оплаченных счетов",minWidth:170,align:"center",format:i=>i.toFixed(2)}];function S(i){const[n,s]=i.split("@"),a=s.replace(/./g,"*");return`${n}@${a}`}const X=i=>{const n=[],s={};i.forEach(a=>{s.hasOwnProperty(a.client_mail)?s[a.client_mail]={created:a.invoice_status==0?s[a.client_mail].created+1:s[a.client_mail].created,createdPrice:a.invoice_status==0?s[a.client_mail].createdPrice+Number(a.invoice_price):s[a.client_mail].createdPrice,actived:a.invoice_status==1?s[a.client_mail].actived+1:s[a.client_mail].actived,activedPrice:a.invoice_status==1?s[a.client_mail].activedPrice+Number(a.invoice_price):s[a.client_mail].activedPrice,closed:a.invoice_status==2?s[a.client_mail].closed+1:s[a.client_mail].closed,closedPrice:a.invoice_status==2?s[a.client_mail].closedPrice+Number(a.invoice_price):s[a.client_mail].closedPrice}:s[a.client_mail]={created:a.invoice_status==0?1:0,createdPrice:a.invoice_status==0?Number(a.invoice_price):0,actived:a.invoice_status==1?1:0,activedPrice:a.invoice_status==1?Number(a.invoice_price):0,closed:a.invoice_status==2?1:0,closedPrice:a.invoice_status==2?Number(a.invoice_price):0}});for(let a in s)n.push({id:a,mail:S(a),created:s[a].created,actived:s[a].actived,closed:s[a].closed,createdPrice:s[a].createdPrice,activedPrice:s[a].activedPrice,closedPrice:s[a].closedPrice});return n};function Y({data:i}){const[n,s]=h.useState(0),[a,g]=h.useState(10),[v,w]=h.useState(X(i.rows)),[k,u]=h.useState(!1),[N,t]=h.useState(!1),[m,j]=h.useState({headers:{title:i.title,code:"",id:"",mail:"",ym_uid:"",countClicks:"",costClicks:"",sumPrice:""},data:{}}),[W,P]=h.useState(!1),B=()=>{u(!1),j({headers:{title:i.title,code:"",id:"",mail:"",ym_uid:"",countClicks:"",costClicks:"",sumPrice:""},data:{}})},T=d=>{u(!0),P(!1),t(!1);const p=new FormData;p.set("mail",d);let x="";switch(m.headers.title){case"wika":x="wika.general";break;case"swagelo":x="swagelo.general";break;case"hylok":x="hylok.general";break;case"hy-lok":x="hy-lok.general";break}A.post(route(x),p).then(l=>{P(!0),j({...m,data:l.data.data,headers:{title:m.headers.title,code:l.data.client_code,id:l.data.client_id,mail:S(l.data.client_mail),ym_uid:l.data.client_ym_uid??"отсутствует",countClicks:l.data.countClicks??"отсутствует",costClicks:l.data.costClicks??"отсутствует",sumPrice:l.data.sum_price}})}).catch(l=>{t(!0),P(!0),console.log(l)})},G=(d,p)=>{s(p)},R=d=>{g(+d.target.value),s(0)};return e.jsxs(I,{sx:{width:"100%",margin:"0 auto"},children:[e.jsx(O,{sx:{maxHeight:600},children:e.jsxs($,{stickyHeader:!0,"aria-label":"sticky table",children:[e.jsxs(z,{children:[e.jsx(f,{children:e.jsx(y,{size:"string",align:"left",colSpan:12,children:e.jsx(r,{variant:"h3",children:i.title})})}),e.jsx(f,{children:D.map(d=>e.jsx(y,{align:d.align,style:{top:57,minWidth:d.minWidth},children:d.label},d.id))})]}),e.jsx(L,{children:v.slice(n*a,n*a+a).map((d,p)=>e.jsx(f,{hover:!0,role:"checkbox",tabIndex:-1,sx:{cursor:"pointer"},onClick:()=>T(d.id),children:D.map(x=>{const l=d[x.id];return e.jsx(y,{align:x.align,children:x.format&&typeof l=="number"?x.format(l):l},x.id)})},p))})]})}),e.jsx(K,{rowsPerPageOptions:[10,25,100],component:"div",count:v.length,rowsPerPage:a,page:n,onPageChange:G,onRowsPerPageChange:R,labelRowsPerPage:"Выводить по :"}),e.jsx(V,{dataModal:m,handleClose:B,open:k,skeleton:W,errAlert:N})]})}const se=({data:i})=>{console.log(i);const[n,s]=h.useState(i.dateUpdateDirect),a=g=>{s(g)};return e.jsxs(q,{dateUpdateDirect:n,updateDirectDate:a,children:[e.jsx(Q,{title:i.title}),e.jsx(o,{maxWidth:"1600px",children:e.jsx(Y,{data:i})})]})};export{se as default};
