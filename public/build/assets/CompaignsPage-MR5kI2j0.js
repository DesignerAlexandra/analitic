import{r,j as e,a as f,b as E}from"./app-Dact1Owb.js";import{ae as d,af as T,a5 as j,an as C,Q as x,ab as R,ad as F,ao as P,a6 as D,P as H,ag as B,ah as G,ai as U,aj as y,ak as w,al as z,am as I}from"./GuestLayout-Bfno-8k0.js";import{T as L}from"./TablePagination-CMvR7O5Q.js";const M=({title:s})=>{const t={wika:!1,swagelo:!1,hylok:!1,hy_lok:!1},[a,i]=r.useState(t);return r.useEffect(()=>{switch(s){case"wika":i({...a,wika:!0});break;case"swagelo":i({...a,swagelo:!0});break;case"hylok":i({...a,hylok:!0});break;case"hy-lok":i({...a,hy_lok:!0});break}},[s]),e.jsx(d,{container:!0,sx:{padding:"10px"},children:e.jsx(d,{item:!0,xs:12,children:e.jsxs(T,{color:"info",variant:"contained",size:"large","aria-label":"Large button group",children:[e.jsx(f,{href:route("compaigns.wika"),children:e.jsx(j,{disabled:a.wika,children:"Wika"})}),e.jsx(f,{href:route("compaigns.swagelo"),children:e.jsx(j,{disabled:a.swagelo,children:"Swagelo"})}),e.jsx(f,{href:route("compaigns.hylok"),children:e.jsx(j,{disabled:a.hylok,children:"Hylok"})}),e.jsx(f,{href:route("compaigns.hy-lok"),children:e.jsx(j,{disabled:a.hy_lok,children:"Hy-lok"})})]})})})};function O({open:s,handleClose:t,skeleton:a,dataForModal:i}){console.log(i);const g=r.useCallback(l=>{const h=[],p=[];for(let n in l.groups)h.push(e.jsxs(C,{className:"compaigns_card",sx:{maxWidth:"360px",borderRight:"solid 1px"},children:[e.jsxs(x,{display:"flex",justifyContent:"space-between",className:"card_text compaigns_text_card",variant:"p",children:[e.jsx("span",{display:"flex",justifyContent:"space-between",className:"titile_header",children:"Название: "}),e.jsx("span",{children:l.groups[n].adGroupName})]}),e.jsxs(x,{display:"flex",justifyContent:"space-between",className:"card_text compaigns_text_card",variant:"p",children:[e.jsx("span",{className:"titile_header",children:"Количество кликов: "}),e.jsx("span",{children:l.groups[n].clicks})]}),e.jsxs(x,{display:"flex",justifyContent:"space-between",className:"card_text compaigns_text_card",variant:"p",children:[e.jsx("span",{className:"titile_header",children:"Cумма затрат: "}),e.jsx("span",{children:l.groups[n].cost.toFixed(2)})]})]}));console.log(l.clients);for(let n in l.clients)l.clients[n].forEach(k=>{k.forEach(u=>{p.push(e.jsxs(C,{className:"compaigns_card",sx:{maxWidth:"860px"},children:[e.jsxs(x,{display:"flex",justifyContent:"space-between",className:"card_text",variant:"p",children:[e.jsx("span",{className:"titile_header",children:"Email клиента: "}),e.jsx("span",{children:u.client_mail})]}),e.jsxs(x,{display:"flex",justifyContent:"space-between",className:"card_text",variant:"p",children:[e.jsx("span",{className:"titile_header",children:"Сумма покупок: "}),e.jsx("span",{children:u.invoice_price})]}),e.jsxs(x,{display:"flex",justifyContent:"space-between",className:"card_text",variant:"p",children:[e.jsx("span",{className:"titile_header",children:"Дата покупки: "}),e.jsx("span",{children:u.invoice_date})]})]}))})});return e.jsxs(e.Fragment,{children:[e.jsx(d,{item:!0,sx:{maxWidth:"500px",width:"100%"},xs:4,children:h.map(n=>n)}),e.jsx(d,{sx:{maxWidth:"360px",width:"100%"},item:!0,xs:6,children:p.map(n=>n)})]})});return e.jsx(r.Fragment,{children:e.jsxs(R,{open:s,onClose:t,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",maxWidth:"xl",children:[e.jsx(F,{children:e.jsxs(d,{container:!0,spacing:2,sx:{width:"1200px",height:"760px"},children:[a?"":e.jsxs(e.Fragment,{children:[e.jsx(d,{item:!0,xs:4,children:e.jsx(P,{variant:"rectangular",width:360,height:660})}),e.jsx(d,{item:!0,xs:6,children:e.jsx(P,{variant:"rectangular",width:760,height:660})})]}),i?g(i):""]})}),e.jsx(D,{children:e.jsx(j,{onClick:t,children:"Закрыть"})})]})})}const _=[{id:"title",label:"Название компании",minWidth:170},{id:"clients",label:"количество клиентов по 1С",minWidth:170,align:"center",format:s=>s},{id:"clicks",label:"общее количество кликов",minWidth:170,align:"center",format:s=>s},{id:"cost",label:"сумма затрат на компанию",minWidth:170,align:"center",format:s=>s.toFixed(2)},{id:"profit",label:"прибыль по клиентам из 1С",minWidth:170,align:"center",format:s=>s.toFixed(2)}],A=s=>{let t=0;for(let a in s)t+=s[a].length;return t},Q=s=>{let t=0;for(let a in s)s[a].forEach(i=>{i.forEach(g=>{t+=Number(g.invoice_price)})});return t},q=s=>{let t=[];for(let a in s)t.push({title:s[a].compaignName,clients:A(s[a].clients),clicks:s[a].clicks,cost:s[a].cost.toFixed(2),profit:Q(s[a].clients),id:a});return t},J=(s,t)=>{setPage(t)},K=s=>{setRowsPerPage(+s.target.value),setPage(0)};function V({compaignsData:s}){const[t,a]=r.useState(0),[i,g]=r.useState(10),[l,h]=r.useState(!1),[p,c]=r.useState(!1),[n,k]=r.useState([]),[u,v]=r.useState([]),N=o=>{h(!0),v(s[o]),c(!0)},S=()=>{h(!1)};return r.useEffect(()=>{k(q(s))},[s]),e.jsxs(H,{sx:{width:"100%",margin:"0 auto"},children:[e.jsx(B,{sx:{maxHeight:600},children:e.jsxs(G,{stickyHeader:!0,"aria-label":"sticky table",children:[e.jsxs(U,{children:[e.jsx(y,{children:e.jsx(w,{size:"string",align:"left",colSpan:12,children:e.jsx(x,{variant:"h3"})})}),e.jsx(y,{children:_.map(o=>e.jsx(w,{align:o.align,style:{minWidth:o.minWidth},children:o.label},o.id))})]}),e.jsx(z,{children:n.slice(t*i,t*i+i).map((o,W)=>e.jsx(y,{hover:!0,role:"checkbox",tabIndex:-1,sx:{cursor:"pointer"},onClick:()=>N(o.id),children:_.map(m=>{const b=o[m.id];return e.jsx(w,{align:m.align,children:m.format&&typeof b=="number"?m.format(b):b},m.id)})},W))})]})}),e.jsx(L,{rowsPerPageOptions:[10,25,100],component:"div",count:n.length,rowsPerPage:i,page:t,onPageChange:J,onRowsPerPageChange:K,labelRowsPerPage:"Выводить по :"}),e.jsx(O,{handleClose:S,open:l,skeleton:p,dataForModal:u})]})}const $=({data:s})=>{const[t,a]=r.useState([]),[i]=r.useState(s.routePath),[g,l]=r.useState(!1),h=c=>{setDateUpdate(c)},p=()=>{let c="compaigns.wika.invoice";switch(i){case"wika":c="compaigns.wika.invoice";break;case"swagelo":c="compaigns.swagelo.invoice";break;case"hylok":c="compaigns.hylok.invoice";break;case"hy-lok":c="compaigns.hy-lok.invoice";break}E.post(route(c)).then(n=>{console.log(n.data),a(n.data.direct),l(!0)}).catch(n=>{console.log(n)})};return r.useEffect(()=>{p()},[]),e.jsxs(I,{dateUpdateDirect:s.dateUpdateDirect,updateDirectDate:h,children:[e.jsx(M,{title:s.routePath}),e.jsx("hr",{}),e.jsx("br",{}),e.jsx(d,{container:!0,children:e.jsx(V,{compaignsData:t})})]})};export{$ as default};
